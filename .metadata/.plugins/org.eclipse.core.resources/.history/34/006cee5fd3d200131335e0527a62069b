package upload;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.SequenceFile;
import org.apache.hadoop.io.Text;

import java.io.FileReader;
import java.io.BufferedReader;
import java.io.File;
import java.io.IOException;


public class sequenceUploader {
	
	String inputFolder;
	String outputFile;
	
	
	public sequenceUploader(String iFolder, String oFile){
		
		inputFolder=iFolder;
		outputFile=oFile;	
		
	}
	
	public void setOuputFile(String oFile){
		outputFile=oFile;
	}
	
	public void setOutputFolder(String oFolder){
		inputFolder=oFolder;
	}
	
	public void generateSequenceFile() throws IOException{
		
		//Prepare the variables needed for the read of all the files in the folder
		String currentFile="";
		FileReader fileReader;
		BufferedReader  bufferedReader;
		String content="";
		
		//Open the folder and take all the files inside
		File folder = new File(inputFolder);
		File [] listofFiles= folder.listFiles();
		
		//Open configuration from cluster
		Configuration conf = new Configuration();
		FileSystem fs = FileSystem.get(conf);
	
		//Key and value to be written in the file
		Text key = new Text();
		Text value = new Text();
		
		//Open the sequence file
		Path outputPath = new Path(outputFile);
		@SuppressWarnings("deprecation")
		SequenceFile.Writer fileOutput = new SequenceFile.Writer(fs, conf, outputPath, org.apache.hadoop.io.Text.class, org.apache.hadoop.io.Text.class);
		
	
		
		
	}
	
	
	
	

}
